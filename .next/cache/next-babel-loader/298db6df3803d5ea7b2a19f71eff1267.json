{"ast":null,"code":"import _regeneratorRuntime from \"/home/sagnik/pro/_t/themeforest-eupsXMaK-martfury-multipurpose-marketplace-react-ecommerce-template(1)/martfury_react_package_2_1_0/martfury-react-2.1.0/martfury-react-2.1.0/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/sagnik/pro/_t/themeforest-eupsXMaK-martfury-multipurpose-marketplace-react-ecommerce-template(1)/martfury_react_package_2_1_0/martfury-react-2.1.0/martfury-react-2.1.0/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from 'react';\nimport { Pagination } from 'antd';\nimport Product from '~/components/elements/products/Product';\nimport ProductWide from '~/components/elements/products/ProductWide';\nimport ProductRepository from '~/repositories/ProductRepository';\nimport ModuleShopSortBy from '~/components/partials/shop/modules/ModuleShopSortBy';\nimport { useRouter } from 'next/router';\nimport { generateTempArray } from '~/utilities/common-helpers';\nimport SkeletonProduct from '~/components/elements/skeletons/SkeletonProduct';\n\nvar ShopItems = function ShopItems(_ref) {\n  var _ref$columns = _ref.columns,\n      columns = _ref$columns === void 0 ? 4 : _ref$columns,\n      _ref$pageSize = _ref.pageSize,\n      pageSize = _ref$pageSize === void 0 ? 12 : _ref$pageSize;\n  var Router = useRouter();\n  var page = Router.query.page;\n  var query = Router.query;\n\n  var _useState = useState(true),\n      listView = _useState[0],\n      setListView = _useState[1];\n\n  var _useState2 = useState(null),\n      productItems = _useState2[0],\n      setProductItems = _useState2[1];\n\n  var _useState3 = useState(0),\n      total = _useState3[0],\n      setTotal = _useState3[1];\n\n  var _useState4 = useState(false),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState('col-xl-4 col-lg-4 col-md-3 col-sm-6 col-6'),\n      classes = _useState5[0],\n      setClasses = _useState5[1];\n\n  function handleChangeViewMode(e) {\n    e.preventDefault();\n    setListView(!listView);\n  }\n\n  function getProducts(_x) {\n    return _getProducts.apply(this, arguments);\n  }\n\n  function _getProducts() {\n    _getProducts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {\n      var responseData;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _context.next = 3;\n              return ProductRepository.getProducts(params);\n\n            case 3:\n              responseData = _context.sent;\n\n              if (responseData) {\n                setProductItems(responseData.items);\n                setTimeout(function () {\n                  setLoading(false);\n                }.bind(this), 250);\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n    return _getProducts.apply(this, arguments);\n  }\n\n  function handlePagination(page, pageSize) {\n    Router.push(\"/shop?page=\".concat(page));\n  }\n\n  function getTotalRecords(_x2) {\n    return _getTotalRecords.apply(this, arguments);\n  }\n\n  function _getTotalRecords() {\n    _getTotalRecords = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(params) {\n      var responseData;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return ProductRepository.getTotalRecords();\n\n            case 2:\n              responseData = _context2.sent;\n\n              if (responseData) {\n                setTotal(responseData);\n              }\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n    return _getTotalRecords.apply(this, arguments);\n  }\n\n  function handleSetColumns() {\n    switch (columns) {\n      case 2:\n        setClasses('col-xl-6 col-lg-6 col-md-6 col-sm-6 col-6');\n        return 3;\n        break;\n\n      case 4:\n        setClasses('col-xl-3 col-lg-4 col-md-6 col-sm-6 col-6');\n        return 4;\n        break;\n\n      case 6:\n        setClasses('col-xl-2 col-lg-4 col-md-6 col-sm-6 col-6');\n        return 6;\n        break;\n\n      default:\n        setClasses('col-xl-4 col-lg-4 col-md-3 col-sm-6 col-6');\n    }\n  }\n\n  useEffect(function () {\n    var params;\n\n    if (query) {\n      if (query.page) {\n        params = {\n          _start: page * pageSize,\n          _limit: pageSize\n        };\n      } else {\n        params = query;\n        params._limit = pageSize;\n      }\n    } else {\n      params = {\n        _limit: pageSize\n      };\n    }\n\n    getTotalRecords();\n    getProducts(params);\n    handleSetColumns();\n  }, [query]); // Views\n\n  var productItemsView;\n\n  if (!loading) {\n    if (productItems && productItems.length > 0) {\n      if (listView) {\n        var items = productItems.map(function (item) {\n          return /*#__PURE__*/_jsx(\"div\", {\n            className: classes,\n            children: /*#__PURE__*/_jsx(Product, {\n              product: item\n            })\n          }, item.id);\n        });\n        productItemsView = /*#__PURE__*/_jsx(\"div\", {\n          className: \"ps-shop-items\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: \"row\",\n            children: items\n          })\n        });\n      } else {\n        productItemsView = productItems.map(function (item) {\n          return /*#__PURE__*/_jsx(ProductWide, {\n            product: item\n          });\n        });\n      }\n    } else {\n      productItemsView = /*#__PURE__*/_jsx(\"p\", {\n        children: \"No product found.\"\n      });\n    }\n  } else {\n    var skeletonItems = generateTempArray(12).map(function (item) {\n      return /*#__PURE__*/_jsx(\"div\", {\n        className: classes,\n        children: /*#__PURE__*/_jsx(SkeletonProduct, {})\n      }, item);\n    });\n    productItemsView = /*#__PURE__*/_jsx(\"div\", {\n      className: \"row\",\n      children: skeletonItems\n    });\n  }\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"ps-shopping\",\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"ps-shopping__header\",\n      children: [/*#__PURE__*/_jsxs(\"p\", {\n        children: [/*#__PURE__*/_jsx(\"strong\", {\n          className: \"mr-2\",\n          children: total\n        }), \"Products found\"]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: \"ps-shopping__actions\",\n        children: [/*#__PURE__*/_jsx(ModuleShopSortBy, {}), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"ps-shopping__view\",\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            children: \"View\"\n          }), /*#__PURE__*/_jsxs(\"ul\", {\n            className: \"ps-tab-list\",\n            children: [/*#__PURE__*/_jsx(\"li\", {\n              className: listView === true ? 'active' : '',\n              children: /*#__PURE__*/_jsx(\"a\", {\n                href: \"#\",\n                onClick: function onClick(e) {\n                  return handleChangeViewMode(e);\n                },\n                children: /*#__PURE__*/_jsx(\"i\", {\n                  className: \"icon-grid\"\n                })\n              })\n            }), /*#__PURE__*/_jsx(\"li\", {\n              className: listView !== true ? 'active' : '',\n              children: /*#__PURE__*/_jsx(\"a\", {\n                href: \"#\",\n                onClick: function onClick(e) {\n                  return handleChangeViewMode(e);\n                },\n                children: /*#__PURE__*/_jsx(\"i\", {\n                  className: \"icon-list4\"\n                })\n              })\n            })]\n          })]\n        })]\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"ps-shopping__content\",\n      children: productItemsView\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"ps-shopping__footer text-center\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"ps-pagination\",\n        children: /*#__PURE__*/_jsx(Pagination, {\n          total: total - 1,\n          pageSize: pageSize,\n          responsive: true,\n          showSizeChanger: false,\n          current: page !== undefined ? parseInt(page) : 1,\n          onChange: function onChange(e) {\n            return handlePagination(e);\n          }\n        })\n      })\n    })]\n  });\n};\n\nexport default ShopItems;","map":null,"metadata":{},"sourceType":"module"}