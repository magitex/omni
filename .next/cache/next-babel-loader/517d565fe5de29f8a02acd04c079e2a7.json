{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport { Spin } from 'antd';\nimport ProductRepository from '~/repositories/ProductRepository';\nimport ProductSearchResult from '~/components/elements/products/ProductSearchResult';\nconst exampleCategories = ['All', 'Babies & Moms', 'Books & Office', 'Cars & Motocycles', 'Clothing & Apparel', ' Accessories', 'Bags', 'Kid’s Fashion', 'Mens', 'Shoes', 'Sunglasses', 'Womens', 'Computers & Technologies', 'Desktop PC', 'Laptop', 'Smartphones', 'Consumer Electrics', 'Air Conditioners', 'Accessories', 'Type Hanging Cell', 'Audios & Theaters', 'Headphone', 'Home Theater System', 'Speakers', 'Car Electronics', 'Audio & Video', 'Car Security', 'Radar Detector', 'Vehicle GPS', 'Office Electronics', 'Printers', 'Projectors', 'Scanners', 'Store & Business', 'Refrigerators', 'TV Televisions', '4K Ultra HD TVs', 'LED TVs', 'OLED TVs', 'Washing Machines', 'Type Drying Clothes', 'Type Horizontal', 'Type Vertical', 'Garden & Kitchen', 'Cookware', 'Decoration', 'Furniture', 'Garden Tools', 'Home Improvement', 'Powers And Hand Tools', 'Utensil & Gadget', 'Health & Beauty', 'Equipments', 'Hair Care', 'Perfumer', 'Wine Cabinets'];\n\nfunction useDebounce(value, delay) {\n  const {\n    0: debouncedValue,\n    1: setDebouncedValue\n  } = useState(value);\n  useEffect(() => {\n    // Update debounced value after delay\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n  return debouncedValue;\n}\n\nconst SearchHeader = () => {\n  const inputEl = useRef(null);\n  const {\n    0: isSearch,\n    1: setIsSearch\n  } = useState(false);\n  const {\n    0: keyword,\n    1: setKeyword\n  } = useState('');\n  const {\n    0: resultItems,\n    1: setResultItems\n  } = useState(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const debouncedSearchTerm = useDebounce(keyword, 300);\n\n  function handleClearKeyword() {\n    setKeyword('');\n    setIsSearch(false);\n    setLoading(false);\n  }\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    Router.push(`/search?keyword=${keyword}`);\n  }\n\n  useEffect(() => {\n    if (debouncedSearchTerm) {\n      setLoading(true);\n\n      if (keyword) {\n        const queries = {\n          _limit: 5,\n          title_contains: keyword\n        };\n        const products = ProductRepository.getRecords(queries);\n        products.then(result => {\n          console.log(result);\n          setLoading(false);\n          setResultItems(result);\n          setIsSearch(true);\n        });\n      } else {\n        setIsSearch(false);\n        setKeyword('');\n      }\n\n      if (loading) {\n        setIsSearch(false);\n      }\n    } else {\n      setLoading(false);\n      setIsSearch(false);\n    }\n  }, [debouncedSearchTerm]); // Views\n\n  let productItemsView, clearTextView, selectOptionView, loadingView, loadMoreView;\n\n  if (!loading) {\n    if (resultItems && resultItems.length > 0) {\n      if (resultItems.length > 5) {\n        loadMoreView = /*#__PURE__*/_jsx(\"div\", {\n          className: \"ps-panel__footer text-center\",\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/search\",\n            children: /*#__PURE__*/_jsx(\"a\", {\n              children: \"See all results\"\n            })\n          })\n        });\n      }\n\n      productItemsView = resultItems.map(product => /*#__PURE__*/_jsx(ProductSearchResult, {\n        product: product\n      }, product.id));\n    } else {\n      productItemsView = /*#__PURE__*/_jsx(\"p\", {\n        children: \"No product found.\"\n      });\n    }\n\n    if (keyword !== '') {\n      clearTextView = /*#__PURE__*/_jsx(\"span\", {\n        className: \"ps-form__action\",\n        onClick: handleClearKeyword,\n        children: /*#__PURE__*/_jsx(\"i\", {\n          className: \"icon icon-cross2\"\n        })\n      });\n    }\n  } else {\n    loadingView = /*#__PURE__*/_jsx(\"span\", {\n      className: \"ps-form__action\",\n      children: /*#__PURE__*/_jsx(Spin, {\n        size: \"small\"\n      })\n    });\n  }\n\n  selectOptionView = exampleCategories.map(option => /*#__PURE__*/_jsx(\"option\", {\n    value: option,\n    children: option\n  }, option));\n  return /*#__PURE__*/_jsxs(\"form\", {\n    className: \"ps-form--quick-search\",\n    method: \"get\",\n    action: \"/\",\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: \"ps-form__categories\",\n      children: /*#__PURE__*/_jsx(\"select\", {\n        className: \"form-control\",\n        children: selectOptionView\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: \"ps-form__input\",\n      children: [/*#__PURE__*/_jsx(\"input\", {\n        ref: inputEl,\n        className: \"form-control\",\n        type: \"text\",\n        value: keyword,\n        placeholder: \"I'm shopping for...\",\n        onChange: e => setKeyword(e.target.value)\n      }), clearTextView, loadingView]\n    }), /*#__PURE__*/_jsx(\"button\", {\n      onClick: handleSubmit,\n      children: \"Search\"\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: `ps-panel--search-result${isSearch ? ' active ' : ''}`,\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"ps-panel__content\",\n        children: productItemsView\n      }), loadMoreView]\n    })]\n  });\n};\n\nexport default SearchHeader;","map":null,"metadata":{},"sourceType":"module"}